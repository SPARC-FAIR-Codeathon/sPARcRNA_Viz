name: Osparc Differential Expression
key: simcore/services/comp/osparc-differential-expression
type: computational
integration-version: 1.0.0
version: 0.1.0
description: |
  Easily generate differential expression results from OSparc data. This service performs comprehensive analysis of single-cell RNA sequencing data, including data normalization, clustering, dimensionality reduction, and pathway activity scoring. It provides visualizations such as t-SNE and UMAP plots for both gene expression and pathway activity, along with detailed cluster information and pathway scores. The service is designed to work with standard input formats and offers flexibility in analysis parameters.
contact: msamdars@stanford.edu
thumbnail: https://github.com/ITISFoundation/osparc-assets/blob/cb43207b6be2f4311c93cd963538d5718b41a023/assets/default-thumbnail-cookiecutter-osparc-service.png?raw=true
authors:
  - name: Mihir Samdarshi
    email: msamdars@stanford.edu
    affiliation: Stanford University School of Medicine, Division of Cardiovascular Medicine
inputs:
  input_folder:
    displayOrder: 1
    label: Input Folder
    description: Folder containing scRNA-seq data (matrix.mtx, features.tsv, barcodes.tsv)
    type: data:*/*
  name:
    displayOrder: 2
    label: Project Name
    description: The name of the dataset being analyzed
    type: string
    defaultValue: sPARcRNA
  min_cells:
    displayOrder: 3
    label: Minimum Cells
    description: Minimum number of cells expressing a gene
    type: integer
    defaultValue: 3
  min_features:
    displayOrder: 4
    label: Minimum Features
    description: Minimum number of features (genes) per cell
    type: integer
    defaultValue: 200
  max_features:
    displayOrder: 5
    label: Maximum Features
    description: Maximum number of features (genes) per cell
    type: integer
    defaultValue: 2500
  resolution:
    displayOrder: 6
    label: Resolution
    description: Resolution parameter for clustering
    type: number
    defaultValue: 0.8
  species:
    displayOrder: 7
    label: Species
    description: Species for GSEA (e.g., "Homo sapiens" or "Mus musculus")
    type: string
    defaultValue: Homo sapiens
  min_pct:
    displayOrder: 8
    label: Minimum Percentage
    description: Minimum percentage for FindAllMarkers
    type: number
    defaultValue: 0.25
  logfc_threshold:
    displayOrder: 9
    label: Log Fold-Change Threshold
    description: Log fold-change threshold for FindAllMarkers
    type: number
    defaultValue: 0.25
  gsea_min_size:
    displayOrder: 10
    label: GSEA Minimum Size
    description: Minimum gene set size for GSEA
    type: integer
    defaultValue: 15
  gsea_max_size:
    displayOrder: 11
    label: GSEA Maximum Size
    description: Maximum gene set size for GSEA
    type: integer
    defaultValue: 500
  category:
    displayOrder: 12
    label: MSigDB Category
    description: MSigDB category for GSEA (e.g., "H" for hallmark gene sets)
    type: string
    defaultValue: H
outputs:
  output_file:
    displayOrder: 1
    label: Processed Data
    description: |
      Zipped file containing processed scRNA-seq data and analysis results. The zip file includes:
      - seurat_object.rds: Serialized R object containing the complete Seurat analysis
      - tsne_plot.png: t-SNE plot of cell clusters based on gene expression
      - dim_reduction_data.csv: CSV file with UMAP and t-SNE coordinates for both gene expression and pathway activity, along with cluster assignments
      - pathway_scores.csv: CSV file with pathway activity scores for each cell
      - cluster_info_genes.csv: CSV file with cluster information based on gene expression, including centroids and top pathways
      - cluster_info_pathways.csv: CSV file with cluster information based on pathway activity, including centroids and top pathways
      - outputs.json: JSON file containing summary statistics and file paths, including:
        - initial_cell_count: Number of cells in the input data
        - final_cell_count: Number of cells after filtering
        - gene_count: Number of genes in the analysis
        - project_name: Name of the analyzed dataset
        - cluster_count_genes: Number of clusters based on gene expression
        - cluster_count_pathways: Number of clusters based on pathway activity
    type: data:application/zip
    fileToKeyMap:
      final_output.zip: output_file